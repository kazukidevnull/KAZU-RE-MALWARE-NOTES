# Malware Analysis Notes
 
 This Directory is for various notes regarding dealing with malware and below you will find various notes in relation to doing Malware Analysis and such

 This file will start with all the main category and topics listed at the start for easy overview and then go into details about each category past it which will contain details about the various things listed at the start, 
 
 the overview part also function as a way for me to quickly note down things i remember/come across to write more details about later, so there will be a lot more in the overview then there's information about them.

------------

## INDEX
+ Static analysis
+ Anti Analysis Notes
+ Dynamic anaysis
+ Unpacking
+ Decryption
+ Deobfuscation
+ Process Injection
+ API hooking
+ Anti-RE
+ Kernal-mode Rootkits
+ Cross-Platform Malware
+ Exploits and Shellcode
+ Bytecode languages(.NET, Java, etc)
+ scripts
+ Macros(Deobfuscation, debugging, reversing)
+ Linux Malware
+ IoT Malware
+ MacOS/iOS
+ Android Malware

----------
DETAILS:



## Static Analysis

### PE Header

analysing of the PE header can tell a lot of information about the file, such as 
+ Is the malware packed?: packers often change section names such as ".text", ".data" and ".rsrc" to other names such as "UPX1"(for UPX packers), also, very few API's visible.
+ is it at dropper or a downloader?: droppers tend to have additional PE or zip files inside their resources, if downloader then you may see things like "URLDownloadToFile" used from the "urlmon.dll" DLL and "ShellExecuteA" API to run the file, but there's many other way to do this.
+ Does it connect to a C&C or website? and how?: there's various API's such as "socket", "send", and "recv" which can tell if it connects to the internet or "connect" and "listen" if they do connect or if listening on a port, "HTTPSendRequestA"(HTTP) and "FTPPutFile"(FTP) from the "wininet.dll" can also indicate what protocol is used.
What functions doe the malware have?: API's such as "FindFirstFileA" are related to file searching, "Process32First", "Process32Next", and "CreateRemoteThread" are used in process injection and "TerminateProcess" are used to terminate other applications.
+ when was the sample created?: "TimeDateStamp" can be used for this, but it can be modified and some compilers are known to completely wack it.
+ country of orign: if timestamp appear usable and valid, it can help give a indication on where in the world it came from, if it's within business hours of a country for instance, then it may be from that area, although this is slightly better then shooting in the dark, it can help point you in the right direction.
+ does it use a forged or stolen certificate?: one of the Data directory entries have a entry related to certificates you can check.





## Anti Analysis Notes

This section will have various notes about things related to analysing of malwares and various things to note in regards to anti-analysis

### String anti analysis:
+ many malware tries to hide strings by pushing them onto the stack, so this is something which may be the case if you see alot of push instructions

### Dynamic API loading 

Common for malwares to use Dynamic API loading to obscure/hide used libraries, 

the most well known API libraries used are:
+ LoadLibraryA(W/ExA/ExW): loads a dynamic library into virtual memory of the calling program and returns it's address.
+ GetProcAddress: This API gets the address of an API given its name or the ordinal value and, the address of the library that contains this API.

By calling these two APIs, malware is able to access APIs that are not written in the import table, there's many other techniques to also to do dynamic API loading.

In some advanced malware, the malware author also hides the names of the libraries and the APIs using encryption or other obfuscation techniques.
